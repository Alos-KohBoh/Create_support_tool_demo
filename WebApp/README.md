# RPGドロップシミュレーター - Webアプリ版

ExcelのVBAで作成されたRPGドロップシミュレーターをモダンなWebアプリケーションに変換しました。

## 🌟 特徴

- **📱 レスポンシブデザイン**: PC、タブレット、スマートフォンに対応
- **💾 データ永続化**: LocalStorageでデータを自動保存
- **📊 グラフ表示**: Chart.jsによる視覚的な結果表示
- **🎨 モダンなUI**: ダークテーマの洗練されたデザイン
- **⚡ 高速動作**: ブラウザ上で瞬時にシミュレーション実行
- **🔄 リアルタイム更新**: 即座に結果を確認可能

## 📁 ファイル構成

```
WebApp/
├── index.html              # メインHTML
├── css/
│   └── style.css          # スタイルシート
└── js/
    ├── models.js          # データモデル定義
    ├── simulator.js       # シミュレーションエンジン
    ├── ui.js             # UI管理
    └── app.js            # メインアプリケーション
```

## 🚀 使い方

### 起動方法

1. `index.html` をブラウザで開く
   - ダブルクリックで開く、または
   - ブラウザにドラッグ&ドロップ

2. ローカルサーバーで起動（推奨）:
   ```bash
   # Pythonの場合
   python -m http.server 8000
   
   # Node.jsの場合
   npx http-server
   ```
   ブラウザで `http://localhost:8000` にアクセス

### 基本的な使い方

#### 1. ガチャシミュレーション

1. **モンスター選択**: ドロップダウンからモンスターを選択
2. **試行回数入力**: シミュレーション回数を入力（1〜100,000）
3. **ガチャ開始**: ボタンをクリックしてシミュレーション実行
4. **結果確認**: 
   - **集計結果**: 各アイテムのドロップ数と割合
   - **期待値**: 理論的な期待ドロップ数
   - **ログ**: 全ドロップ履歴（最新100件）
   - **グラフ**: 実績vs期待値の棒グラフ

#### 2. 期待値計算

- 試行回数に基づいた理論値を計算
- 確率 × 試行回数で各アイテムの期待値を算出

#### 3. データ管理

**モンスター追加**:
- モンスター名、危険度、レア度を設定
- 後からドロップテーブルを設定可能

**アイテム追加**:
- アイテム名、種別、レア度を設定

**ドロップ設定**:
- モンスターごとにドロップテーブルを編集
- 各アイテムのドロップ確率を設定（合計100%）
- リアルタイムで確率の合計を確認

## 📊 機能一覧

### コア機能

| 機能 | 説明 |
|------|------|
| ガチャシミュレーション | 確率に基づいたランダムドロップ |
| 期待値計算 | 試行回数×確率の理論値算出 |
| 統計表示 | ドロップ数、割合の集計 |
| ログ記録 | 全試行の詳細履歴 |

### データ管理

| 機能 | 説明 |
|------|------|
| モンスター管理 | 追加・編集 |
| アイテム管理 | 追加・編集 |
| ドロップテーブル設定 | 確率設定・検証 |
| LocalStorage保存 | 自動データ永続化 |

### UI機能

| 機能 | 説明 |
|------|------|
| タブ切り替え | 結果表示の切り替え |
| グラフ表示 | Chart.jsによる可視化 |
| モーダルダイアログ | データ入力フォーム |
| レスポンシブ | モバイル対応 |

## 🎮 サンプルデータ

初回起動時に以下のサンプルデータが自動で作成されます:

### モンスター

| モンスター | 危険度 | レア度 | ドロップテーブル |
|-----------|--------|--------|------------------|
| スライム | 低 | コモン | ポーション(50%), 木の盾(25%), 金貨(20%), エリクサー(5%) |
| ドラゴン | 高 | レア | エリクサー(40%), 鉄の剣(30%), 金貨(20%), 伝説の剣(10%) |
| ゴブリン | 低 | コモン | ポーション(40%), 鉄の剣(35%), 木の盾(20%), 金貨(5%) |

### アイテム

| アイテム | 種別 | レア度 |
|---------|------|--------|
| ポーション | 回復 | コモン |
| エリクサー | 回復 | レア |
| 鉄の剣 | 武器 | コモン |
| 伝説の剣 | 武器 | レジェンド |
| 木の盾 | 防具 | コモン |
| 金貨 | 素材 | アンコモン |

## 🔧 技術スタック

- **HTML5**: セマンティックマークアップ
- **CSS3**: 
  - Grid/Flexbox レイアウト
  - CSS Variables
  - アニメーション
  - レスポンシブデザイン
- **JavaScript (ES6+)**:
  - クラスベース設計
  - モジュール化
  - イベント駆動
  - LocalStorage API
- **Chart.js**: グラフライブラリ

## 🎨 デザイン

- **ダークテーマ**: 目に優しい配色
- **モダンUI**: カードレイアウト、グラデーション
- **アニメーション**: スムーズな画面遷移
- **レスポンシブ**: 全デバイス対応

## 📱 対応ブラウザ

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## ⚙️ カスタマイズ

### 配色変更

`css/style.css` の `:root` 部分を編集:

```css
:root {
    --primary-color: #4CAF50;    /* メインカラー */
    --secondary-color: #2196F3;  /* セカンダリカラー */
    --danger-color: #f44336;     /* 警告色 */
    /* ... */
}
```

### 試行回数上限変更

`js/app.js` の `runSimulation()` メソッド内:

```javascript
if (trialCount <= 0 || trialCount > 100000) {  // ここを変更
    alert('試行回数は1〜100000の範囲で入力してください');
    return;
}
```

## 🆚 VBA版との対応

| VBA機能 | Web版実装 |
|---------|----------|
| `ガチャ開始()` | `simulator.runSimulation()` |
| `期待値計算()` | `simulator.calculateExpectedValues()` |
| `AddMonster()` | `app.saveMonster()` |
| `AddItem()` | `app.saveItem()` |
| Dictionary | JavaScript Object / Map |
| Randomize/Rnd | `Math.random()` |
| UserForm | モーダルダイアログ |
| ワークシート | LocalStorage |

## 🚀 拡張アイデア

- [ ] データのエクスポート/インポート（JSON/CSV）
- [ ] 複数モンスターの比較機能
- [ ] 確率の偏差分析
- [ ] ガチャ天井システムのシミュレーション
- [ ] テーマカラーの切り替え
- [ ] モンスター/アイテムの削除機能
- [ ] ドロップ履歴のフィルタリング
- [ ] PWA対応（オフライン動作）

## 📝 ライセンス

このプロジェクトは元のExcel VBAシステムを基に作成されています。

## 🙏 使用ライブラリ

- [Chart.js](https://www.chartjs.org/) - MIT License

---

**開発日**: 2025年12月10日
